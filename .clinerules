# Claude Code Rules –¥–ª—è Performance Testing

## Performance —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ö–æ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã
- –ü–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
- –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/–∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∞–Ω–∏–º–∞—Ü–∏–π –∏–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
- –ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º Pull Request
- –ü—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–∞—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

### Workflow –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–°–æ–∑–¥–∞–Ω–∏–µ baseline**
```bash
npm run test:perf -- --comment="Baseline: –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏"
```

2. **–í–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥**
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤

3. **–¢–µ—Å—Ç –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π**
```bash
npm run test:perf -- --comment="–ü–æ—Å–ª–µ: –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
```

4. **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**
```bash
npm run test:compare
```

### CPU Throttling

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –∏—Å–ø–æ–ª—å–∑—É–π –ø–∞—Ä–∞–º–µ—Ç—Ä `--cpu`:

```bash
# –ë–µ–∑ throttling (–º–æ—â–Ω—ã–π –¥–µ—Å–∫—Ç–æ–ø)
npm run test:perf -- --comment="Desktop performance"

# 4x –∑–∞–º–µ–¥–ª–µ–Ω–∏–µ (—Å—Ä–µ–¥–Ω–∏–π –Ω–æ—É—Ç–±—É–∫)
npm run test:perf -- --cpu=4 --comment="Mid-range laptop"

# 6x –∑–∞–º–µ–¥–ª–µ–Ω–∏–µ (—Å–ª–∞–±–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ)
npm run test:perf -- --cpu=6 --comment="Low-end device"
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- `--cpu=1` (default) - —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞, –±—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
- `--cpu=4` - —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ PR
- `--cpu=6` - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —à–∏—Ä–æ–∫–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏
- `--cpu=8` - —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è, –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

### –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫

#### ‚úÖ –•–æ—Ä–æ—à–æ
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —Ä–µ—Å–∞–π–∑–∞: <100ms
- FPS: >30
- –î–µ–≥—Ä–∞–¥–∞—Ü–∏—è: <20%
- –ü–∞–º—è—Ç—å: <80%

#### ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è: 100-500ms
- FPS: 15-30
- –î–µ–≥—Ä–∞–¥–∞—Ü–∏—è: 20-100%
- –ü–∞–º—è—Ç—å: 80-90%

#### üö® –ö—Ä–∏—Ç–∏—á–Ω–æ
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è: >500ms
- FPS: <15
- –î–µ–≥—Ä–∞–¥–∞—Ü–∏—è: >100%
- –ü–∞–º—è—Ç—å: >90%

### –ü–æ–∏—Å–∫ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–ï—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è:

1. **–ì–ª–∞–≤–Ω—ã–µ –≤–∏–Ω–æ–≤–Ω–∏–∫–∏ (–ø—Ä–æ–≤–µ—Ä—è–π –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å):**
   - `<BgToSvg>` –≤ Keypad - resize listener –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç PNG –ø—Ä–∏ –∫–∞–∂–¥–æ–º resize
     - ‚ö†Ô∏è **–í–ê–ñ–ù–û**: resize listener –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –û–¢–ö–õ–Æ–ß–ï–ù (–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω)
     - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `toPng` –∏–∑ `html-to-image` - –º–µ–¥–ª–µ–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
   - `<BgToSvg>` –≤ MainPage - –º–µ–Ω—å—à–µ –≤–ª–∏—è–µ—Ç, –Ω–æ —Ç–æ–∂–µ –ø—Ä–æ–≤–µ—Ä—å

2. –ü—Ä–æ–≤–µ—Ä—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏:
   - `<Keypad>` - glass-effect, –∞–Ω–∏–º–∞—Ü–∏–∏, 10 –∫–Ω–æ–ø–æ–∫ —Å –¥–∏—Ä–µ–∫—Ç–∏–≤–∞–º–∏
   - `<GeFilter>` - SVG —Ñ–∏–ª—å—Ç—Ä—ã, ResizeObserver
   - `<GlassEffect>` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–π –∫–Ω–æ–ø–∫–µ

3. –ü—Ä–æ–≤–µ—Ä—å –¥–∏—Ä–µ–∫—Ç–∏–≤—ã:
   - `v-mask-element` - ResizeObserver (–ö–†–ò–¢–ò–ß–ù–û, –Ω–µ –æ—Ç–∫–ª—é—á–∞—Ç—å!)
   - `v-hover-distortion` - resize listener (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ)
   - `v-glass-effect` - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã

4. –û—Ç–∫–ª—é—á–∞–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ:
```bash
# –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤ App.vue
npm run test:perf -- --comment="–ë–µ–∑ Keypad"
npm run test:compare
```

5. –ü—Ä–æ–≤–µ—Ä—è–π resize —Å–æ–±—ã—Ç–∏—è:
```bash
# –ü–æ–∏—Å–∫ –≤—Å–µ—Ö resize —Å–ª—É—à–∞—Ç–µ–ª–µ–π
grep -r "resize" src/ --include="*.vue" --include="*.js"
```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **BgToSvg –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–ö–†–ò–¢–ò–ß–ù–û)**
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π `toPng` –≤–º–µ—Å—Ç–æ `toSvg` (–≤ 2 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ)
   - ‚úÖ –û–¢–ö–õ–Æ–ß–ò resize listener - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ mount –∏ data change
   - –ï—Å–ª–∏ –Ω—É–∂–µ–Ω resize - –¥–æ–±–∞–≤—å debounce –º–∏–Ω–∏–º—É–º 300-500ms
   - –†–∞—Å—Å–º–æ—Ç—Ä–∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–º–µ—Å—Ç–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

2. **–£–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ resize listeners**
   - –î–µ–±–∞—É–Ω—Å–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π (300-500ms)
   - –ù–ï –æ—Ç–∫–ª—é—á–∞–π ResizeObserver –≤ `v-mask-element` (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è glass-effect)

3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞**
   - –ú–µ–º–æ–∏–∑–∞—Ü–∏—è computed —Å–≤–æ–π—Å—Ç–≤
   - –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–ø–∏—Å–∫–æ–≤
   - Lazy loading –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

4. **–ü–∞–º—è—Ç—å**
   - –û—á–∏—Å—Ç–∫–∞ listeners –≤ onUnmounted
   - –û—Ç–º–µ–Ω–∞ –∞–Ω–∏–º–∞—Ü–∏–π –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ç–µ—á–µ–∫ –≤ DevTools

### –§–∞–π–ª—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä—å:
- **`src/components/bg-to-svg/BgToSvg.vue`** - –ì–õ–ê–í–ù–´–ô –í–ò–ù–û–í–ù–ò–ö –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏
  - resize listener –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω (—Å—Ç—Ä–æ–∫–∏ 58-64)
  - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è toPng –≤–º–µ—Å—Ç–æ toSvg
- `src/App.vue` - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- `src/components/keypad/Keypad.vue` - —Ç—è–∂–µ–ª—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç BgToSvg
- `src/components/glass-effect/*.vue` - SVG —Ñ–∏–ª—å—Ç—Ä—ã
- `src/directives/mask-element/maskElement.js` - ResizeObserver (–ù–ï –¢–†–û–ì–ê–¢–¨!)
- `src/directives/hover-distortion/hoverDistortion.js` - resize listener
- `src/pages/main-page/**` - –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

–î–ª—è CI/CD –¥–æ–±–∞–≤—å –≤ workflow:
```yaml
- name: Performance Test
  run: |
    npm run dev &
    sleep 5
    npm run test:perf:headless -- --cpu=4 --comment="CI: ${{ github.sha }}"
    npm run test:compare || echo "Warning: Performance regression detected"
```

### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤

**Baseline (–¥–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏):**
- SVG + resize listener: 10.85s, 467ms avg, –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è +468% ‚ùå
- PNG + resize listener: 5.17s, 187ms avg, –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è +501% ‚ö†Ô∏è
- PNG –±–µ–∑ resize listener: 2.61s, 74ms avg, –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è –ù–ï–¢ ‚úÖ

**–í—ã–≤–æ–¥—ã:**
- BgToSvg —Å resize listener - –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏
- PNG –≤ 2 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ SVG
- –û—Ç–∫–ª—é—á–µ–Ω–∏–µ resize listener —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –ø–æ–ª–Ω–æ—Å—Ç—å—é

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `tests/e2e/README.md`
- –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è: `tests/e2e/README.md#—Ç–∏–ø–∏—á–Ω—ã–µ-—Å—Ü–µ–Ω–∞—Ä–∏–∏`
- Troubleshooting: `tests/e2e/README.md#troubleshooting`
