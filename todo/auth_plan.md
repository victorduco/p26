–ö–æ–Ω—Ç–µ–∫—Å—Ç –∏ —Ü–µ–ª—å (–¥–ª—è –≤—Å–µ—Ö)
‚Ä¢ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: Vue SPA (Vite).
‚Ä¢ –•–æ—Å—Ç–∏–Ω–≥: Heroku (–æ–¥–∏–Ω web dyno).
‚Ä¢ –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ: –ø–æ–∫–∞ –∫–æ–¥ –Ω–µ –≤–≤–µ–¥—ë–Ω ‚Äî –Ω–µ–ª—å–∑—è –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ñ–∞–π–ª—ã –∫—Ä–æ–º–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏–Ω—Ç—Ä–æ –¥–ª—è –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
‚Ä¢ UX: –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤–≤–æ–¥–∞ –∫–æ–¥–∞ - –∫–µ–π–ø–∞–¥
‚Ä¢ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ ‚Äî –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ; –¥–æ—Å—Ç—É–ø –¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ httpOnly cookie; —Å—Ç–∞—Ç–∏–∫–∞ –∏ HTML –Ω–µ –æ—Ç–¥–∞—é—Ç—Å—è –±–µ–∑ –≤–∞–ª–∏–¥–Ω–æ–π –∫—É–∫–∏.

‚∏ª

üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–∫–∞–∫ –≤—Å—ë —Å—Ç—ã–∫—É–µ—Ç—Å—è) 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ª—é–±–æ–π –∑–∞—â–∏—â—ë–Ω–Ω—ã–π URL ‚Üí —Å–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—É–∫—É ‚Üí –µ—Å–ª–∏ –Ω–µ—Ç, 302 –Ω–∞ /gate?next=.... 2. –ù–∞ /gate –≥—Ä—É–∑—è—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ (–ø—É–±–ª–∏—á–Ω—ã–µ) –∞—Å—Å–µ—Ç—ã ¬´–≤—Ö–æ–¥–Ω–æ–π¬ª —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–æ—Ç–¥–µ–ª—å–Ω—ã–π —ç–Ω—Ç—Ä–∏–ø–æ–∏–Ω—Ç). 3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –∫–æ–¥ ‚Üí POST /api/check-code ‚Üí —Å–µ—Ä–≤–µ—Ä —Å–≤–µ—Ä—è–µ—Ç —Å ACCESS_CODE (Heroku Config Var) ‚Üí —Å—Ç–∞–≤–∏—Ç httpOnly cookie. 4. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–µ—Ä–≤–µ—Ä –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –∫ –ª—é–±–æ–º—É –∑–∞—â–∏—â—ë–Ω–Ω–æ–º—É —Ä–µ—Å—É—Ä—Å—É (SPA, —á–∞–Ω–∫–∏, –º–µ–¥–∏–∞, API). 5. –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–µ–¥–∏–∞ –ª–∏–±–æ –ø—Ä–æ–∫—Å–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–µ—Ä, –ª–∏–±–æ –æ—Ç–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ presigned URLs (–µ—Å–ª–∏ S3).

‚∏ª

‚öôÔ∏è BACKEND (Heroku / Express) ‚Äî –¢–ó

0. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
   ‚Ä¢ Node 18+, Express.
   ‚Ä¢ cookie-parser, helmet, express-rate-limit.
   ‚Ä¢ (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: compression –¥–ª—è gzip/br).

1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (Heroku Config Vars)
   ‚Ä¢ ACCESS_CODE_1, ACCESS_CODE_2, ACCESS_CODE_3, ‚Äî —Ü–∏—Ñ—Ä–æ–≤–æ–π –∫–æ–¥ (4 —Ü–∏—Ñ—Ä—ã).
   ‚Ä¢ COOKIE_NAME ‚Äî –∏–º—è –∫—É–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é auth).
   ‚Ä¢ COOKIE_TTL_MS ‚Äî —Å—Ä–æ–∫ –∂–∏–∑–Ω–∏ ( 3600000 = 1 —á–∞—Å).
   ‚Ä¢ COOKIE_SECURE ‚Äî true –Ω–∞ –ø—Ä–æ–¥–µ.
   ‚Ä¢ SESSION_SECRET ‚Äî —Å–æ–ª—å/—Å–µ–∫—Ä–µ—Ç –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–¥–ø–∏—Å—å/–≤–µ—Ä—Å–∏—é).
   ‚Ä¢ RATE_LIMIT_WINDOW_MS ‚Äî –∞–Ω—Ç–∏-–±—Ä—É—Ç—Ñ–æ—Ä—Å –Ω–∞ /api/check-code.

2. –≠–Ω–¥–ø–æ–π–Ω—Ç—ã
   ‚Ä¢ POST /api/check-code
   –í—Ö–æ–¥: { code: "12345678" }
   –õ–æ–≥–∏–∫–∞:
   ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å code === ACCESS_CODE.
   ‚Ä¢ –ï—Å–ª–∏ –æ–∫ ‚Äî –≤—ã—Å—Ç–∞–≤–∏—Ç—å httpOnly cookie:
   ‚Ä¢ Set-Cookie: ${COOKIE_NAME}=ok|v=<AUTH_VERSION>; HttpOnly; Secure; SameSite=Strict; Path=/; Max-Age=${COOKIE_TTL_MS/1000}
   ‚Ä¢ –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å—å/–≤–µ—Ä—Å–∏—é –≤ –∑–Ω–∞—á–µ–Ω–∏–µ, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å, –µ—Å–ª–∏ AUTH_VERSION –∏–∑–º–µ–Ω–∏—Ç—Å—è.
   ‚Ä¢ –û—Ç–≤–µ—Ç: { ok: true } / { ok: false } (401).
   ‚Ä¢ –ù–∞ —ç–Ω–¥–ø–æ–π–Ω—Ç –ø–æ–≤–µ—Å–∏—Ç—å rate-limit (–Ω–∞–ø—Ä–∏–º–µ—Ä 10 –ø–æ–ø—ã—Ç–æ–∫ / 15 –º–∏–Ω—É—Ç –Ω–∞ IP).
   ‚Ä¢ POST /api/logout
   –õ–æ–≥–∏–∫–∞: —Å—Ç–∞–≤–∏—Ç –∫—É–∫—É —Å Max-Age=0 (—É–¥–∞–ª–µ–Ω–∏–µ). –û—Ç–≤–µ—Ç { ok: true }.
   ‚Ä¢ GET /api/whoami (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è FE UX)
   –õ–æ–≥–∏–∫–∞: –µ—Å–ª–∏ –≤–∞–ª–∏–¥–Ω–∞—è –∫—É–∫–∞ ‚Üí { ok: true }, –∏–Ω–∞—á–µ { ok: false }.

3. –ü–æ—Ä—è–¥–æ–∫ middleware (–≤–∞–∂–Ω–æ)

   1. helmet() (–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏).
   2. express.json() (—á—Ç–µ–Ω–∏–µ JSON).
   3. cookieParser() (–ø–∞—Ä—Å–∏–º –∫—É–∫–∏).
   4. Auth-–≥–µ–π—Ç (—Å–º. –Ω–∏–∂–µ).
   5. express.static() (–æ—Ç–¥–∞—á–∞ –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤, –Ω–æ –ø–æ—Å–ª–µ –≥–µ–π—Ç–∞).
   6. SPA-—Ñ–æ–ª–±–µ–∫ GET \* ‚Üí index.html (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤–∞–ª–∏–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏).

4. Auth-–≥–µ–π—Ç (—Å–µ—Ä–¥—Ü–µ –∑–∞—â–∏—Ç—ã)
   ‚Ä¢ –í –≥–µ–π—Ç–µ —Ä–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ–ª—å–∫–æ:
   ‚Ä¢ GET /gate –∏ –∞—Å—Å–µ—Ç—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–æ–ª—å–∫–æ –¥–ª—è gate-—Å—Ç—Ä–∞–Ω–∏—Ü—ã (—Å–º. —Ä–∞–∑–¥–µ–ª FE/–º—É–ª—å—Ç–∏-—ç–Ω—Ç—Ä–∏–ø–æ–π–Ω—Ç).
   ‚Ä¢ POST /api/check-code –∏ POST /api/logout, GET /api/whoami.
   ‚Ä¢ GET /health (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞).
   ‚Ä¢ –í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ (–≤–∫–ª—é—á–∞—è /, /case/_, /assets/_.js|css|png|jpg|webp|svg|‚Ä¶) ‚Üí –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:
   ‚Ä¢ –µ—Å—Ç—å –∫—É–∫–∞ ${COOKIE_NAME} —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º ¬´–≤–∞–ª–∏–¥–Ω–æ¬ª
   ‚Ä¢ –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî 302 redirect –Ω–∞ /gate?next=<originalUrl>.

–ü–æ—á–µ–º—É —Ç–∞–∫: —ç—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –¥–∞–∂–µ –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –∑–Ω–∞–µ—Ç —Ç–æ—á–Ω—ã–π URL —á–∞–Ω–∫–∞/–∫–∞—Ä—Ç–∏–Ω–∫–∏, –æ–Ω –ø–æ–ª—É—á–∏—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç, –∞ –Ω–µ —Ñ–∞–π–ª.

5. –û—Ç–¥–∞—á–∞ —Å—Ç–∞—Ç–∏–∫–∏ (Vite dist/)
   ‚Ä¢ –ü–æ—Å–ª–µ –≥–µ–π—Ç–∞ –≤–∫–ª—é—á–∞–µ–º express.static(dist) ‚Äî —Ç–µ–ø–µ—Ä—å —Ñ–∞–π–ª—ã –≤—ã–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤–∞–ª–∏–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏.
   ‚Ä¢ –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏:
   ‚Ä¢ –î–ª—è –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤: Cache-Control: private, no-store (—á—Ç–æ–±—ã –±—Ä–∞—É–∑–µ—Ä—ã/–ø—Ä–æ–∫—Å–∏ –Ω–µ –∫—ç—à–∏—Ä–æ–≤–∞–ª–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ–µ).
   ‚Ä¢ –î–ª—è gate-–∞—Å—Å–µ—Ç–æ–≤ (–ø—É–±–ª–∏—á–Ω–∞—è —á–∞—Å—Ç—å): –º–æ–∂–Ω–æ Cache-Control: public, max-age=... (–æ–Ω–∏ –Ω–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã).

6. Gate-–∞—Å—Å–µ—Ç—ã: allowlist —á–µ—Ä–µ–∑ Vite manifest

–ß—Ç–æ–±—ã —Å–µ—Ä–≤–µ—Ä –∑–Ω–∞–ª, –∫–∞–∫–∏–µ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –ø—É–±–ª–∏—á–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ /gate, BE –Ω–∞ —Å—Ç–∞—Ä—Ç–µ:
‚Ä¢ —á–∏—Ç–∞–µ—Ç dist/manifest.json,
‚Ä¢ –≤—ã—Ç–∞—Å–∫–∏–≤–∞–µ—Ç –∏–∑ –Ω–µ–≥–æ –∫–ª—é—á–∏ ¬´gate-—ç–Ω—Ç—Ä–∏–ø–æ–∏–Ω—Ç–∞¬ª –∏ –∏—Ö file, css, assets,
‚Ä¢ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç allowlist –ø—É—Ç–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, /gate-assets/... –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ /assets/gate.[hash].js/css),
‚Ä¢ –≤ auth-–≥–µ–π—Ç–µ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Ç–æ–ª—å–∫–æ —ç—Ç–∏ –ø—É—Ç–∏ –±–µ–∑ –∫—É–∫–∏; –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî –ø–æ–¥ –∑–∞—â–∏—Ç—É.

–≠—Ç–æ –∏–∑–±–∞–≤–ª—è–µ—Ç –æ—Ç —Ä—É—á–Ω–æ–≥–æ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è —Ö—ç—à-–∏–º—ë–Ω –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –±–∏–ª–¥–∞.

7. –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–µ–¥–∏–∞/–¥–∞–Ω–Ω—ã–µ
   ‚Ä¢ –í–∞—Ä–∏–∞–Ω—Ç A (–ø—Ä–æ—â–µ): —Ö—Ä–∞–Ω–∏—Ç—å –∏—Ö –Ω–µ –≤ dist, –∞ –≤ –ø—Ä–∏–≤–∞—Ç–Ω–æ–π –ø–∞–ø–∫–µ (–≤–Ω–µ express.static).
   –û—Ç–¥–∞–≤–∞—Ç—å —á–µ—Ä–µ–∑ —Ä–æ—É—Ç /media/:id ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫—É–∫–∏ ‚Üí res.sendFile()/—Å—Ç—Ä–∏–º.
   ‚Ä¢ –í–∞—Ä–∏–∞–Ω—Ç B (–º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–π): –∑–∞–≥—Ä—É–∂–∞—Ç—å –º–µ–¥–∏–∞ –≤ S3 –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –±–∞–∫–µ—Ç; –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –≤—ã–¥–∞–≤–∞—Ç—å presigned URL (–∂–∏–∑–Ω—å 5‚Äì15 –º–∏–Ω—É—Ç).
   –ù–∞ FE –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å URL –≤ <img>/fetch. –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ ‚Äî –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –Ω–æ–≤—ã–π.

8. –õ–æ–≥–∏ –∏ –º–µ—Ç—Ä–∏–∫–∏
   ‚Ä¢ —Ñ–∞–π–ª 1 - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å 401/302 –ø–æ –∑–∞—â–∏—â—ë–Ω–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º, –ø–æ–ø—ã—Ç–∫–∏ /api/check-code (–±–µ–∑ —Å–∞–º–æ–≥–æ –∫–æ–¥–∞), IP, UA, timestamp.- —Ñ–∞–π–ª 2 - —Å–ø–∏—Å–æ–∫ –∫–æ–¥–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≤–≤–µ–ª–∏ –ø–ª—é—Å –∏–Ω—Ñ—É –æ –∫–ª–∏–µ–Ω—Ç–µ- —Ñ–∞–π–ª 3 - —Å–ø–∏—Å–æ–∫ –∫–æ–¥–æ–≤ –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –≤–≤–µ–ª–∏ –ø–ª—é—Å –∏–Ω—Ñ—É –æ –∫–ª–∏–µ–Ω—Ç–µ —Ç–∏–ø–∞ –∞–π–ø–∏ –∏ —Ç–¥
   ‚Ä¢ GET /health ‚Üí 200 OK (–¥–ª—è Heroku/–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞).

9. –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
   ‚Ä¢ helmet:
   ‚Ä¢ X-Content-Type-Options: nosniff
   ‚Ä¢ Referrer-Policy: no-referrer (–∏–ª–∏ same-origin)
   ‚Ä¢ Permissions-Policy (–∑–∞–ø—Ä–µ—Ç –ª–∏—à–Ω–∏—Ö API)
   ‚Ä¢ –î–ª—è –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: Cache-Control: private, no-store, Pragma: no-cache.

10. Definition of Done (BE)
    ‚Ä¢ –ë–µ–∑ –∫—É–∫–∏ –Ω–∏–∫–∞–∫—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É SPA (–≤–∫–ª—é—á–∞—è /) –∏ –Ω–∏–∫–∞–∫–æ–π —Ñ–∞–π–ª –∏–∑ dist/assets –ø–æ–ª—É—á–∏—Ç—å –Ω–µ–ª—å–∑—è (–≤—Å–µ–≥–¥–∞ 302 /gate).
    ‚Ä¢ –° –∫—É–∫–æ–π ‚Äî –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –æ–±—ã—á–Ω–æ.
    ‚Ä¢ –°–º–µ–Ω–∞ ACCESS_CODE + AUTH_VERSION ‚Üí —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Å—Å–∏–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.
    ‚Ä¢ Rate-limit –Ω–∞ /api/check-code –¥–µ–π—Å—Ç–≤—É–µ—Ç (–ø–æ—Å–ª–µ N –ø–æ–ø—ã—Ç–æ–∫ ‚Üí 429).
    ‚Ä¢ –ü—É–±–ª–∏—á–Ω—ã–µ gate-–∞—Å—Å–µ—Ç—ã –æ—Ç–¥–∞—é—Ç—Å—è –±–µ–∑ –∫—É–∫–∏; –æ—Å—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏–∫–∞ ‚Äî —Ç–æ–ª—å–∫–æ —Å –∫—É–∫–æ–π.

‚∏ª

üß© FRONTEND (Vue / Vite) ‚Äî –¢–ó

1. –î–≤–∞ —ç–Ω—Ç—Ä–∏–ø–æ–π–Ω—Ç–∞ (multi-page build)

–ù—É–∂–Ω–æ, —á—Ç–æ–±—ã –∞—Å—Å–µ—Ç—ã gate-—Å—Ç—Ä–∞–Ω–∏—Ü—ã –±—ã–ª–∏ –æ—Ç–¥–µ–ª–µ–Ω—ã –æ—Ç –∞—Å—Å–µ—Ç–æ–≤ –æ—Å–Ω–æ–≤–Ω–æ–π SPA:
‚Ä¢ index.html ‚Üí –æ—Å–Ω–æ–≤–Ω–æ–π —ç–Ω—Ç—Ä–∏–ø–æ–π–Ω—Ç (–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ).
‚Ä¢ gate.html ‚Üí —ç–Ω—Ç—Ä–∏–ø–æ–π–Ω—Ç –ø—É–±–ª–∏—á–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã (—Ñ–æ—Ä–º–∞ –≤–≤–æ–¥–∞ –∫–æ–¥–∞).

–í vite.config –∑–∞–¥–∞—Ç—å –¥–≤–∞ –≤—Ö–æ–¥–∞ (rollup input).
–í—ã–≤–æ–¥: —Ç–∞–∫, —á—Ç–æ–±—ã –∞—Å—Å–µ—Ç—ã gate-—Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–º–µ–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–ª—é—á–∏ –≤ manifest.json (—É–¥–æ–±–Ω–æ –¥–ª—è BE-allowlist).
–ü–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Ç—å gate-–∞—Å—Å–µ—Ç—ã –ø–æ–¥ –ø—Ä–µ—Ñ–∏–∫—Å, –Ω–∞–ø—Ä–∏–º–µ—Ä /gate-assets/ (–Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π build.assetsDir –¥–ª—è gate).

–ï—Å–ª–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —ç–Ω—Ç—Ä–∏–ø–æ–π–Ω—Ç–æ–≤ —Å–ª–æ–∂–Ω–æ ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π Plan B: –∏–Ω–ª–∞–π–Ω–∏—Ç—å JS/CSS –≥–µ–π—Ç-—Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä—è–º–æ –≤ gate.html, —á—Ç–æ–±—ã BE –Ω–µ –ø–æ–Ω–∞–¥–æ–±–∏–ª–æ—Å—å –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å —Ö—ç—à-–∞—Å—Å–µ—Ç—ã.

2. /gate ‚Äî –ø–æ–≤–µ–¥–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   ‚Ä¢ –ü–æ–ª–µ –≤–≤–æ–¥–∞ (—Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã), –∫–Ω–æ–ø–∫–∞ ¬´–í–æ–π—Ç–∏¬ª.
   ‚Ä¢ –õ–æ–∫–∞–ª—å–Ω–∞—è UX-–≤–∞–ª–∏–¥–∞—Ü–∏—è (–¥–ª–∏–Ω–∞ ‚â• 6).
   ‚Ä¢ POST /api/check-code —Å —Ç–µ–ª–æ–º { code }.
   ‚Ä¢ –ï—Å–ª–∏ { ok: true } ‚Üí —á–∏—Ç–∞—Ç—å next –∏–∑ query ‚Üí location.replace(next || '/').
   ‚Ä¢ –û–±—Ä–∞–±–æ—Ç–∫–∞ 401/429 (–æ—à–∏–±–∫–∞ –∫–æ–¥–∞ / —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫).
   ‚Ä¢ –ö–Ω–æ–ø–∫–∞ ¬´–í—ã–π—Ç–∏¬ª (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ‚Üí POST /api/logout ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /gate.

FE –Ω–µ –≤–∏–¥–∏—Ç httpOnly cookie ‚Äî –∏ –Ω–µ –Ω–∞–¥–æ. –§–∞–∫—Ç ¬´–≤–æ—à—ë–ª¬ª –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ –ø–æ—Å–ª–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –Ω–∞—á–∞–ª–∏ –≥—Ä—É–∑–∏—Ç—å—Å—è.

3. –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è SPA
   ‚Ä¢ –ù–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ —Ä–æ—É—Ç–æ–≤ (–µ—ë –¥–µ–ª–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä).
   ‚Ä¢ –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å ¬´—à—Ç–æ—Ä–∫—É¬ª/—Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Å–ª—É—á–∞–π –ø—Ä—è–º–æ–≥–æ –ø–æ–ø–∞–¥–∞–Ω–∏—è, –Ω–æ —ç—Ç–æ UX-–∫–æ–º—Ñ–æ—Ä—Ç, –Ω–µ –∑–∞—â–∏—Ç–∞.

4. –ú–µ–¥–∏–∞ –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   ‚Ä¢ –ù–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ–¥–∏–∞ –≤ –±–∞–Ω–¥–ª (–∏–Ω–∞—á–µ Vite –ø–æ–ª–æ–∂–∏—Ç –∏—Ö –≤ dist/assets, –∏ –æ–Ω–∏ —Å—Ç–∞–Ω—É—Ç –∑–∞—â–∏—â—ë–Ω–Ω—ã–º–∏ –∫–∞–∫ —Å—Ç–∞—Ç–∏–∫–∞ ‚Äî —á—Ç–æ –æ–∫, –Ω–æ —É–≤–µ–ª–∏—á–∏—Ç –≤–µ—Å –±–∞–Ω–¥–ª–∞ –∏ –Ω–µ—É–¥–æ–±–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –¥–æ—Å—Ç—É–ø–æ–º).
   ‚Ä¢ –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –æ—Ç–¥–∞–≤–∞—Ç—å –º–µ–¥–∏–∞ ‚Äî –ø–æ–ª—É—á–∞—Ç—å –∏—Ö URL —Å –±—ç–∫–∞ (–ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ) –∏–ª–∏ presigned URL –æ—Ç S3 –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

5. –°—Ç–∞—Ç–∏–∫–∞ –∏ –∫—ç—à
   ‚Ä¢ –î–ª—è gate-–∞—Å—Å–µ—Ç–æ–≤ –º–æ–∂–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞.
   ‚Ä¢ –î–ª—è SPA-–∞—Å—Å–µ—Ç–æ–≤ –±—Ä–∞—É–∑–µ—Ä –≤—Å—ë —Ä–∞–≤–Ω–æ –±—É–¥–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å, –Ω–æ BE –æ—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å private, no-store ‚Üí –±—Ä–∞—É–∑–µ—Ä –Ω–µ –¥–æ–ª–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏—Ö –≤ –∫—ç—à–µ –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π/–ø—Ä–æ—Ñ–∏–ª–µ–π.

–ß–µ–∫–ª–∏—Å—Ç
‚Ä¢ –ë–µ–∑ –≤—Ö–æ–¥–∞: –æ—Ç–∫—Ä—ã–≤–∞–µ–º /, /case/123, /assets/\*.js ‚Üí –≤—Å–µ–≥–¥–∞ —É—Ö–æ–¥–∏–º –Ω–∞ /gate.
‚Ä¢ –í–≤–æ–¥–∏–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥ ‚Üí –ø–æ–ø–∞–¥–∞–µ–º –Ω–∞ –∏—Å—Ö–æ–¥–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç, SPA –≥—Ä—É–∑–∏—Ç—Å—è.
‚Ä¢ –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–∞ –∑–∞—â–∏—â—ë–Ω–Ω–æ–º —Ä–æ—É—Ç–µ ‚Äî –≤—Å—ë –æ–∫.
‚Ä¢ –õ–æ–≥–∞—É—Ç ‚Üí –ª—é–±–∞—è –∑–∞—â–∏—â—ë–Ω–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤–Ω–æ–≤—å —É–≤–æ–¥–∏—Ç –Ω–∞ /gate.
‚Ä¢ –û—à–∏–±–∫–∞ –∫–æ–¥–∞ ‚Üí –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ; –ø–æ—Å–ª–µ N –ø–æ–ø—ã—Ç–æ–∫ ‚Äî –±–ª–æ–∫ (429) –∏ —Ç–∞–π–º–µ—Ä –Ω–∞ –∫–Ω–æ–ø–∫–µ.

7. Definition of Done (FE)
   ‚Ä¢ gate-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω–æ, –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–∞–Ω–¥–ª–∞.
   ‚Ä¢ –ü–æ—Å–ª–µ { ok: true } –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –æ–±–Ω–æ–≤–ª—è—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É; –æ–Ω –ø–æ–ø–∞–¥–∞–µ—Ç –Ω–∞ –Ω—É–∂–Ω—ã–π —Ä–æ—É—Ç.
   ‚Ä¢ –ù–∏–∫–∞–∫–∏—Ö –ø—Ä—è–º—ã—Ö —Å—Å—ã–ª–æ–∫ –Ω–∞ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ —Ä–∞–∑–º–µ—Ç–∫–µ gate.

‚∏ª

üîí –ú–∏–Ω–∏-—É–≥—Ä–æ–∑–º–æ–¥–µ–ª—å –∏ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏
‚Ä¢ –§—Ä–æ–Ω—Ç–µ–Ω–¥-–æ–±—Ö–æ–¥ –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–¥–∞—ë—Ç —Ñ–∞–π–ª—ã –¥–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
‚Ä¢ –ö—É–∫–∏ ‚Äî HttpOnly + Secure + SameSite=Strict.
‚Ä¢ –°–º–µ–Ω–∞ –∫–æ–¥–∞ + AUTH_VERSION –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏.
‚Ä¢ –ê–Ω—Ç–∏-–±—Ä—É—Ç—Ñ–æ—Ä—Å (rate-limit) –Ω–∞ /api/check-code.
‚Ä¢ –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–µ–¥–∏–∞: —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ –∏–ª–∏ S3 presigned; –Ω–µ –≤—Ç—ã–∫–∞–µ–º –∏—Ö –ø—Ä—è–º—ã–º–∏ –ø—É–±–ª–∏—á–Ω—ã–º–∏ URL.
‚Ä¢ –õ–æ–≥–∏ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞ ‚Äî –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

‚∏ª

‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è ¬´Definition of Done¬ª –¥–ª—è –≤—Å–µ–≥–æ —Ä–µ—à–µ–Ω–∏—è 1. –ë–µ–∑ –∫—É–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å index.html, JS/CSS —á–∞–Ω–∫–∏, —Ä–æ—É—Ç—ã, –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–µ–¥–∏–∞ –∏ API ‚Äî –≤—Å–µ–≥–¥–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /gate. 2. –° –∫—É–∫–æ–π –≤—Å—è SPA —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –æ–±—ã—á–Ω–æ. 3. Gate-–∞—Å—Å–µ—Ç—ã –æ—Ç–¥–∞—é—Ç—Å—è –ø—É–±–ª–∏—á–Ω–æ; –∏—Ö —Å–ø–∏—Å–æ–∫ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ manifest.json (–∏–ª–∏ –≤—Å—ë –∑–∞–∏–Ω–ª–∞–π–Ω–µ–Ω–æ –≤ gate.html). 4. –ï—Å—Ç—å POST /api/check-code —Å rate-limit –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. 5. –ï—Å—Ç—å POST /api/logout. 6. –°–º–µ–Ω–∞ ACCESS_CODE –∏/–∏–ª–∏ AUTH_VERSION –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ ¬´—Ä–æ–Ω—è–µ—Ç¬ª —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Å—Å–∏–∏. 7. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –¥–µ–ø–ª–æ—è –Ω–∞ Heroku: —Å–ø–∏—Å–æ–∫ env vars, –∫–æ–º–∞–Ω–¥—ã –¥–µ–ø–ª–æ—è, –ø–æ—Ä—è–¥–æ–∫ –±–∏–ª–¥–æ–≤.

–≠—Ç–∞–ø 0 ‚Äî –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–µ–ø–æ
‚Ä¢ –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É backend/ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
‚Ä¢ –î–æ–±–∞–≤–∏—Ç—å README_backend.md —Å –∫—Ä–∞—Ç–∫–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º, env-—Å–ø–∏—Å–∫–æ–º –∏ DoD.
‚Ä¢ –î–æ–±–∞–≤–∏—Ç—å .nvmrc/engines (–≤–µ—Ä—Å–∏—è Node), .editorconfig, .gitignore.

–≠—Ç–∞–ø 1 ‚Äî –°–∫–µ–ª–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞
‚Ä¢ –í backend/: package.json, src/server.ts|js, Procfile (web: node dist/server.js –∏–ª–∏ ts-node –≤ dev).
‚Ä¢ –í–∫–ª—é—á–∏—Ç—å app.set('trust proxy', 1) –¥–ª—è Heroku.
‚Ä¢ –ü–æ–¥–∫–ª—é—á–∏—Ç—å helmet, express.json, cookie-parser.

–≠—Ç–∞–ø 2 ‚Äî –ö–æ–Ω—Ñ–∏–≥–∏ –∏ env
‚Ä¢ –ó–∞–≤–µ—Å—Ç–∏ .env.example —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏: ACCESS_CODE_1..3, COOKIE_NAME, COOKIE_TTL_MS, COOKIE_SECURE, SESSION_SECRET, AUTH_VERSION, RATE_LIMIT_WINDOW_MS.
‚Ä¢ –ü—Ä–æ—á–∏—Ç–∞—Ç—å env —á–µ—Ä–µ–∑ process.env (–±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π) –∏ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å—Ç–∞—Ä—Ç–µ.

–≠—Ç–∞–ø 3 ‚Äî Auth-gate (—è–¥—Ä–æ)
‚Ä¢ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å middleware-–≥–µ–π—Ç: –ø—Ä–æ–ø—É—Å–∫ /gate, /api/check-code, /api/logout, /api/whoami, /health.
‚Ä¢ –û—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ httpOnly-–∫—É–∫–∏ ‚Üí –∏–Ω–∞—á–µ 302 /gate?next=....
‚Ä¢ –í—ã–Ω–µ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫—É –∫—É–∫–∏ + HMAC-–ø–æ–¥–ø–∏—Å—å + –≤–µ—Ä—Å–∏—é (AUTH_VERSION).

–≠—Ç–∞–ø 4 ‚Äî –≠–Ω–¥–ø–æ–π–Ω—Ç—ã
‚Ä¢ POST /api/check-code (+ rate-limit).
‚Ä¢ POST /api/logout.
‚Ä¢ GET /api/whoami.
‚Ä¢ –í—Å–µ –æ—Ç–≤–µ—Ç—ã ‚Äî —Å—Ç—Ä–æ–≥–∏–µ –∫–æ–¥—ã (200/401/429).

–≠—Ç–∞–ø 5 ‚Äî –°—Ç–∞—Ç–∏–∫–∞ –∏ gate-–∞—Å—Å–µ—Ç—ã
‚Ä¢ –ü–æ–¥–∫–ª—é—á–∏—Ç—å –ø–∞—Ä—Å–µ—Ä Vite manifest.json (–∏–∑ backend/dist/manifest.json).
‚Ä¢ –ü–æ—Å—Ç—Ä–æ–∏—Ç—å allowlist –∞—Å—Å–µ—Ç–æ–≤ gate-–≤—Ö–æ–¥–∞.
‚Ä¢ express.static(dist) –ø–æ–¥–∫–ª—é—á–∞—Ç—å –ø–æ—Å–ª–µ –≥–µ–π—Ç–∞; –¥–ª—è gate-–∞—Å—Å–µ—Ç–æ–≤ ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—É–±–ª–∏—á–Ω—ã–π —Ö–µ–Ω–¥–ª–µ—Ä.
‚Ä¢ –ó–∞–≥–æ–ª–æ–≤–∫–∏: gate ‚Äî public, max-age, –∑–∞—â–∏—â—ë–Ω–Ω–æ–µ ‚Äî private, no-store.

–≠—Ç–∞–ø 6 ‚Äî –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–µ–¥–∏–∞
‚Ä¢ –í–∞—Ä–∏–∞–Ω—Ç A: /media/:id (–ø–∞–ø–∫–∞ –≤–Ω–µ express.static) ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫—É–∫–∏ ‚Üí —Å—Ç—Ä–∏–º.
‚Ä¢ –í–∞—Ä–∏–∞–Ω—Ç B: S3 presigned URL (TTL 5‚Äì15 –º–∏–Ω) ‚Äî –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å (–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ env).

–≠—Ç–∞–ø 7 ‚Äî –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏
‚Ä¢ helmet —Å referrerPolicy, x-content-type-options, permissions-policy.
‚Ä¢ –ë–∞–∑–æ–≤–∞—è CSP –¥–ª—è /gate (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è).
‚Ä¢ SameSite=Strict, Secure, HttpOnly –¥–ª—è –∫—É–∫–∏.

–≠—Ç–∞–ø 8 ‚Äî –õ–æ–≥–∏ –∏ –º–µ—Ç—Ä–∏–∫–∏
‚Ä¢ –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤ stdout –≤ JSON: —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è (auth_ok|auth_fail|rate_limited|redirect), ip, ua, ts.
‚Ä¢ GET /health ‚Üí 200 –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

–≠—Ç–∞–ø 9 ‚Äî –¢–µ—Å—Ç—ã/–ª–æ–∫–∞–ª–∫–∞
‚Ä¢ –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –∫—É–∫–∏/–≤–µ—Ä—Å–∏–∏/—Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤.
‚Ä¢ –°–∫—Ä–∏–ø—Ç—ã npm: dev, start, test.
‚Ä¢ –õ–æ–∫–∞–ª—å–Ω–æ –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å dist/ (–ø–æ–ª–æ–∂–∏—Ç—å –∑–∞–≥–ª—É—à–∫—É –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ –∏ —Ñ–∞–π–ª gate).

–≠—Ç–∞–ø 10 ‚Äî CI/CD: –∞—Ä—Ç–µ—Ñ–∞–∫—Ç FE ‚Üí backend
‚Ä¢ –í FE-workflow: —Å–æ–±—Ä–∞—Ç—å SPA –∏ gate, –∑–∞–≥—Ä—É–∑–∏—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç frontend-dist (–≤–∫–ª—é—á–∞—è manifest.json).
‚Ä¢ –í backend-workflow: —Å–∫–∞—á–∞—Ç—å frontend-dist –∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å –≤ backend/dist/ –¥–æ –¥–µ–ø–ª–æ—è.
‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –º–∞–Ω–∏—Ñ–µ—Å—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –∏ –ø–∞—Ä—Å–∏—Ç—Å—è –Ω–∞ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞.

–≠—Ç–∞–ø 11 ‚Äî GitHub Actions (–¥–µ–ø–ª–æ–π –Ω–∞ Heroku)
‚Ä¢ –°–æ–∑–¥–∞—Ç—å .github/workflows/backend-deploy.yml.
‚Ä¢ –°–µ–∫—Ä–µ—Ç—ã –≤ —Ä–µ–ø–æ: HEROKU_API_KEY, HEROKU_APP_NAME, HEROKU_EMAIL.
‚Ä¢ –î–∂–æ–±: 1. actions/checkout 2. –ó–∞–≥—Ä—É–∑–∫–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞ frontend-dist ‚Üí –∫–æ–ø–∏—è –≤ backend/dist/ 3. actions/setup-node (—Ç–∞ –∂–µ –≤–µ—Ä—Å–∏—è) 4. npm ci –≤ backend/ (+ npm run build, –µ—Å–ª–∏ TS) 5. –î–µ–ø–ª–æ–π –Ω–∞ Heroku (—á–µ—Ä–µ–∑ heroku/actions –∏–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: login ‚Üí build ‚Üí release).
‚Ä¢ –ü–µ—Ä–µ–∫–∞—Ç env –≤ Heroku (–æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ): –∑–∞–¥–∞—Ç—å –≤—Å–µ Config Vars + NODE_ENV=production.

–≠—Ç–∞–ø 12 ‚Äî –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å –∏ –∞–ª–µ—Ä—Ç—ã
‚Ä¢ –ü–æ–¥–∫–ª—é—á–∏—Ç—å Papertrail/LogDNA (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).
‚Ä¢ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –ø–æ —á–∞—Å—Ç–æ—Ç–µ auth_fail/rate_limited –∏ 5xx.

–≠—Ç–∞–ø 13 ‚Äî DoD —á–µ–∫
‚Ä¢ –ë–µ–∑ –∫—É–∫–∏ –Ω–∏—á–µ–≥–æ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –Ω–µ –æ—Ç–¥–∞—Ç—å (–≤–∫–ª—é—á–∞—è index.html –∏ –∞—Å—Å–µ—Ç—ã).
‚Ä¢ –° –∫—É–∫–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç SPA –∏ –º–µ–¥–∏–∞.
‚Ä¢ –°–º–µ–Ω–∞ ACCESS_CODE/AUTH_VERSION –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Å–µ—Å—Å–∏–∏.
‚Ä¢ Gate-–∞—Å—Å–µ—Ç—ã –±–µ—Ä—É—Ç—Å—è –∏–∑ manifest.json –∏ –∫–µ—à–∏—Ä—É—é—Ç—Å—è –ø—É–±–ª–∏—á–Ω–æ.
‚Ä¢ Rate-limit –Ω–∞ /api/check-code –∞–∫—Ç–∏–≤–µ–Ω.

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ ‚Äî –¥–∞–ª—å—à–µ –¥–æ–∫–∏–Ω—É –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã Procfile, backend-deploy.yml –∏ –ø–∞—Ä—Å–µ—Ä –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞.
